import db_localhost


def get_yelp_task():
    sql = 'select id,res_url from price_level.chat_restaurant where price_level="" and source="yelp"'
    for line in db_localhost.QueryBySQL(sql):
        yield line['id'], line['res_url'].strip()


def get_daodao_task():
    # sql = 'select id,res_url from price_level.chat_restaurant where price_level="" and source="daodao" and city_id in ("50573","50554","20310","50163","50161","50160","50167","50165","50164","50642","50643","50169","50168","50646","50647","50644","50645","50707","50720","50800","50432","50777","50425","50802","50490","50361","50803","50727","50360","50804","50726","50773","50440","50806","50441","50807","50497","50442","50705","50443","50444","50445","50264","50265","50266","50267","50260","50261","50262","50263","50347","50346","50345","50344","50268","50269","50341","50340","50674","50831","50436","50495","50840","50703","50830","50719","50864","50862","50863","50860","50861","50192","50190","50191","50196","50197","50195","50198","50199","50462","50358","50460","50461","50466","50467","50464","50359","50468","50469","50299","50298","50711","50291","50290","50293","50292","50295","50294","50297","50296","50713","50714","50715","50716","50717","50835","50127","50126","50125","50124","50123","50122","50121","50120","50686","50687","50684","50685","50682","50648","50129","50128","50649","50048","50049","50518","50519","50044","50045","50046","50047","50040","50041","50042","50043","50480","50841","50837","50640","50465","50641","50852","50633","50632","50631","50630","50637","50636","50635","50634","50639","50638","50696","50228","50229","50839","50595","50220","50221","50692","50226","50227","20312","20258","20259","20252","20250","20251","20256","50118","20254","20255","50119","50509","50508","50834","20311","50314","50315","50316","50317","50310","50311","50099","50098","50097","50095","50094","50093","50059","50091","50090","50111","50259","50258","50709","50708","50255","50254","50257","50256","50251","50250","50253","50252","50503","50502","50488","50489","20179","20178","20177","50485","20175","20174","20173","20172","20171","20170","50858","50552","50001","50002","50003","50004","50005","50006","50007","50008","50009","50558","50559","50381","50790","50791","50419","50380","50794","50795","50796","50797","50413","50412","50411","50410","50417","50416","50415","50414","50850","50842","50433","50843","50815","50801","50434","20257","50544","50389","50677","50676","50675","50388","50673","50569","50671","50670","50431","50568","50679","50430","50075","50074","50077","50076","50178","50070","50073","50072","50174","50175","50176","50177","50079","50078","50172","50563","50562","50793","20298","20299","20296","50579","20294","20292","20293","50211","50210","50213","50215","50214","50217","50216","50350","50351","50352","50353","50354","50355","50356","50357","50805","50814","50457","50324","50455","50859","50454","50312","50853","50453","50851","50313","50857","50856","50855","50452","50593","50844","50451","50322","50329","50328","50459","50458","50325","50318","50327","50326","50321","50320","50323","50092","50845","50288","50289","50282","50283","50280","50281","50286","50287","50284","50285","50846","50838","50130","50131","50132","50133","50134","50135","50136","50137","50138","50139","50847","50039","50038","50529","50528","50706","50031","50030","50033","50032","50035","50034","50037","50036","50704","50349","50571","50348","50702","50701","50700","50659","50658","50343","50342","50145","50144","50147","50146","50141","50140","50143","50142","50624","50625","50626","50627","50149","50148","50622","50623","50578","20267","20266","20265","20264","20263","20262","20261","20260","20269","20268","20308","20309","20304","20305","20306","20307","20300","20301","20302","20303","50657","50656","50517","50088","50089","50363","50362","50365","50364","50367","50366","50080","50081","50082","50083","50084","50085","50086","50087","50718","50109","50248","50249","50246","50247","50244","50245","50242","50243","50240","50241","50484","20176","50486","20168","20169","50108","20160","20161","20162","20163","20164","20165","20166","20167","50482","50483","50404","50405","50406","50407","50400","50401","50402","50403","50567","50566","50565","50564","50408","50409","50561","50560","50769","50768","50819","50818","50817","50816","50767","50106","50813","50812","50811","50810","50585","50584","50587","50586","50581","50580","50583","50582","20242","50589","50588","50745","50849","50836","20246","50660","50661","50662","50663","50664","50665","50666","50667","50668","50669","50744","50066","50067","50064","50065","50062","50063","50060","50061","50101","50100","50103","50102","50105","50104","50068","50069","50504","50553","50526","50550","50848","50523","50551","50522","50556","50521","50557","20184","50520","20182","20183","20180","20181","50527","50555","50107","50615","50614","50617","50616","50611","50525","50613","50612","50524","50619","50618","50514","50450","50202","50203","50200","50201","50206","50207","50204","50205","50209","50729","50823","50610","50418","50826","50782","50728","50824","50463","50825","50798","50446","50799","50781","50828","50448","50449","50723","50829","50725","50724","50338","50339","50336","50337","50334","50335","50332","50333","50330","50331","50447","50780","20151","20150","20153","20152","20155","20154","20157","20156","20159","20158","50854","50534","50535","50536","50537","50530","50531","50532","50533","50423","50538","50539","50383","50382","50028","50029","50387","50386","50385","50384","50435","50023","50020","50021","50026","50027","50024","50025","50420","50730","50743","50731","50710","50421","50747","50620","50506","50746","50156","50157","50154","50155","50153","50150","50151","50651","50650","50653","50652","50655","50654","50158","50159","50621","20270","50712","20072","20073","20070","20071","50822","50628","50629","50789","50505","50179","50372","50373","50370","50371","50376","50377","50374","50375","50378","50379","50672","50279","50278","50788","50273","50272","50271","50270","50277","50276","50275","50274","50820","50493","50792","50492","50507","50491","50181","50180","50183","50182","50185","50184","50187","50186","50188","50678","50496","50471","50470","50473","50472","50475","50474","50477","50476","50479","50478","50572","50494","50574","50575","50576","50577","50808","50809","50778","50779","50776","50071","50774","50775","50772","50499","50770","50771","50596","50597","50594","50498","50592","50501","50590","50591","50827","50598","50599","50487","50500","50699","50688","50695","50694","50697","50689","50691","50690","50693","50171","50053","50052","50051","50050","50057","50056","50055","50054","50112","50113","50110","50058","50116","50117","50114","50115","50439","50683","50698","50680","50681","50481","50545","50438","50456","50606","50607","50604","50605","50602","50603","50600","50601","50833","50608","50609","50541","50540","50543","50319","50516","50542","50239","50238","50237","50236","50235","50233","50232","50231","50230","20249","20248","50515","20241","50512","20243","50546","20245","20244","20247","50513","50510","50369","50548","50821","50511","50368","20297","50732","50733","50309","50308","50786","50303","50302","50301","50300","50307","50306","50305","50304","50832","50783","50437","20142","20143","20140","20141","20146","20147","20144","20145","20148","20149","50426","50427","50424","50017","50016","50015","50014","50013","50012","50547","50010","50549","50422","50019","50018","50787","50570","50785","50784","50398","50399","50428","50429","50394","50395","50396","50397","50390","50391","50392","50393")'
    sql = 'select id,res_url from price_level.chat_restaurant where price_level="" and source="daodao"'
    for line in db_localhost.QueryBySQL(sql):
        yield line['id'], line['res_url'].strip()


if __name__ == '__main__':
    # yelp
    # for m_id, url in get_yelp_task():
    #     print m_id, url

    # daodao
    count = 0
    for m_id, url in get_daodao_task():
        # print m_id, url
        count += 1
    print count
