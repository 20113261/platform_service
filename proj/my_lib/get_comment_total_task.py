import json
import db_114_35_attr
import db_114_35_rest
import db_114_35_shop


def get_attr_url():
    sql = 'select id,url from chat_attraction where city_id in ("50009","50018","50020","50028","50033","50035","50042","50043","50049","50052","50057","50058","50059","50061","50062","50063","50066","50067","50069","50070","50072","50073","50074","50075","50077","50078","50079","50080","50082","50083","50086","50087","50088","50089","50090","50091","50092","50093","50094","50095","50097","50098","50100","50101","50102","50103","50104","50105","50106","50107","50108","50109","50110","50111","50112","50113","50114","50115","50116","50118","50119","50120","50121","50122","50123","50124","50125","50126","50129","50130","50131","50134","50137","50138","50139","50142","50146","50147","50148","50149","50153","50174","50176","50183","50184","50196","50199","50203","50204","50214","50215","50220","50245","50256","50301","50307","50309","50379","50398","50424","50444","50460","50473","50477","50490","50557","50624","50652","50655","50743","50744","50745","50746","50747","50767","50770","50771","50772","50773","50775","50776","50777","50778","50780","50781","50783","50784","50785","50786","50787","50788","50789","50790","50792","50793","50794","50795","50796","50797","50801","50809","50810","50812","50813","50817","50818","50819","50826","50827","50828","50829","50831","50832","50833","50837","50838","50841","50842","50843","50844","50846","50847","50848","50851","50859","50860","50861")'
    comment_url_set = set()
    for line in db_114_35_attr.QueryBySQL(sql):
        url = line['url']
        miaoji_id = line['id']
        try:
            comment_url_set.add((json.loads(url)['daodao'], miaoji_id))
        except:
            continue
    return comment_url_set


def get_shop_url():
    sql = 'select id,url from chat_shopping where city_id in ("50009","50018","50020","50028","50033","50035","50042","50043","50049","50052","50057","50058","50059","50061","50062","50063","50066","50067","50069","50070","50072","50073","50074","50075","50077","50078","50079","50080","50082","50083","50086","50087","50088","50089","50090","50091","50092","50093","50094","50095","50097","50098","50100","50101","50102","50103","50104","50105","50106","50107","50108","50109","50110","50111","50112","50113","50114","50115","50116","50118","50119","50120","50121","50122","50123","50124","50125","50126","50129","50130","50131","50134","50137","50138","50139","50142","50146","50147","50148","50149","50153","50174","50176","50183","50184","50196","50199","50203","50204","50214","50215","50220","50245","50256","50301","50307","50309","50379","50398","50424","50444","50460","50473","50477","50490","50557","50624","50652","50655","50743","50744","50745","50746","50747","50767","50770","50771","50772","50773","50775","50776","50777","50778","50780","50781","50783","50784","50785","50786","50787","50788","50789","50790","50792","50793","50794","50795","50796","50797","50801","50809","50810","50812","50813","50817","50818","50819","50826","50827","50828","50829","50831","50832","50833","50837","50838","50841","50842","50843","50844","50846","50847","50848","50851","50859","50860","50861")'
    comment_url_set = set()
    print sql
    for line in db_114_35_shop.QueryBySQL(sql):
        url = line['url']
        miaoji_id = line['id']
        try:
            comment_url_set.add((json.loads(url)['daodao'], miaoji_id))
        except:
            continue
    return comment_url_set


def get_rest_url():
    sql = 'select id,res_url from chat_restaurant where city_id in ("50009","50018","50020","50028","50033","50035","50042","50043","50049","50052","50057","50058","50059","50061","50062","50063","50066","50067","50069","50070","50072","50073","50074","50075","50077","50078","50079","50080","50082","50083","50086","50087","50088","50089","50090","50091","50092","50093","50094","50095","50097","50098","50100","50101","50102","50103","50104","50105","50106","50107","50108","50109","50110","50111","50112","50113","50114","50115","50116","50118","50119","50120","50121","50122","50123","50124","50125","50126","50129","50130","50131","50134","50137","50138","50139","50142","50146","50147","50148","50149","50153","50174","50176","50183","50184","50196","50199","50203","50204","50214","50215","50220","50245","50256","50301","50307","50309","50379","50398","50424","50444","50460","50473","50477","50490","50557","50624","50652","50655","50743","50744","50745","50746","50747","50767","50770","50771","50772","50773","50775","50776","50777","50778","50780","50781","50783","50784","50785","50786","50787","50788","50789","50790","50792","50793","50794","50795","50796","50797","50801","50809","50810","50812","50813","50817","50818","50819","50826","50827","50828","50829","50831","50832","50833","50837","50838","50841","50842","50843","50844","50846","50847","50848","50851","50859","50860","50861")'
    comment_url_set = set()
    for line in db_114_35_rest.QueryBySQL(sql):
        url = line['res_url']
        miaoji_id = line['id']
        try:
            comment_url_set.add((url, miaoji_id))
        except:
            continue
    return comment_url_set


def get_total():
    return get_attr_url() | get_shop_url() | get_rest_url()


if __name__ == '__main__':
    print len(get_attr_url())
    print len(get_shop_url())
    print len(get_rest_url())
    print len(get_total())
